
ソースコード、レッスンを検索
 
 marui2
 レッスン一覧 React入門 #13 setStateで値を更新しよう


文字起こしを閉じる≪ 前へ  完了  次へ ≫
0:03
さて先ほどのメッセージは消しておきました。
0:05
では Counter Component に state をセットできたので、次はクリックイベントを仕込んでカウントアップされるようにしておきましょう。
0:14
まずは onClick としてあげれば良いですね。
0:17
では countUp というメソッドを作っていきましょう。
0:21
ではこちらに書いていきます。
0:24
countUp としてあげましょう。
0:28
ふつうに考えると this.state.count を 1 増やしたいので、 this.state.count = this.state.count + 1; と書けば OK かなと思うかと思います。
0:35
ところが実は React では this.state に値がセットできるのは constructor の中だけで、それ以外の場所では setState を使わないといけないというルールになっています。
0:50
したがって上の処理を書きたい時は setState したあとに、 count キーの値は this.state.count + 1 だよ、としてあげなければなりません。
1:02
たださらに注意点があって setState が実行されるタイミングは React が勝手に決めるので、こう書いてしまうと count の値がほかの処理で書き換わってしまって、うまくカウントアップできない場合もあります。
1:15
そこで setState では state の変更前の値を取得できるようになっていて、その場合は prevState で…、アロー関数式でこのように書いてあげれば、 prevState に直前の値が入ってくるので、その値を使って書き換えてあげれば OK です。
1:37
では count というキーの値を prevState.count + 1 としてあげればカウントされるかと思います。
1:47
ちなみに React では setState するたびに render() が呼ばれて、それによって新しい値で UI が再描画されるといった仕組みになっていることも覚えておきましょう。
1:58
ではこれで見てあげます。
2:03
こちらでクリックしてあげると…、エラーが出ているのがわかります。
2:07
これですが…、 JavaScript の仕様によるもので、このように countUp を括弧なしで呼ぶとメソッドの中では this が undefined になってしまうからですね。
2:19
このあたりはややこしいのですが、エラーを直すには constructor の方で this.countUp にこの class 自体を bind してあげれば良いので this.countUp = this.countUp.bind(this); としてあげれば OK になるはずです。
2:36
では見てあげましょう。
2:40
こちらでクリックしてあげると…、こうですねちゃんとカウントアップできていて、エラーが出ていないので OK かと思います。
2:46
ではもう Developer Tools は要らないのでいったん消してあげて、続きは次回にしていきましょう。
この動画について 
よくある質問 (0)
ソースコード 
デモ 
setStateで値を更新するときの注意点について見ていきます。

setState
prevState
bind
このレッスンの問題を報告する

動画一覧 (19)
サービスメニュー
レッスン一覧
プレミアム会員
法人向けライセンス
運営からのお知らせ
プログラミング学習ガイド
ヘルプ
ご利用にあたって
このサイトについて
利用規約
プライバシーポリシー
運営企業情報
採用情報
教材利用について
動画広告について
お問い合わせ
学習支援ツール
Dotinstall Pane
ソーシャルメディア
Facebookページ
Twitter (@dotinstall)
公式ブログ
更新情報
 新着レッスンRSS
 新着補足情報RSS
Copyright c 2011-2019 dotinstall.com. All Rights Reserved.

